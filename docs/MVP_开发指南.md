# TGç¤¾åŒºMVPå¼€å‘æŒ‡å— - æœåŠ¡å™¨ç‰ˆ

## âœ… æœåŠ¡å™¨ä¿¡æ¯ (å·²ç¡®è®¤)

- **æœåŠ¡å™¨IP**: 150.109.95.231 (å…¬ç½‘IP)
- **å†…ç½‘IP**: 10.3.0.13
- **ç”¨æˆ·å**: ubuntu
- **æ“ä½œç³»ç»Ÿ**: Ubuntu Server 24.04 LTS 64bit
- **SSHè¿žæŽ¥**: âœ… å·²é€šè¿‡VS Codeè¿žæŽ¥æˆåŠŸ

## ðŸŽ¯ MVPç›®æ ‡

åŸºäºŽç”¨æˆ·æµç¨‹æ–‡æ¡£ï¼Œæˆ‘ä»¬è¦å®žçŽ°ä¸€ä¸ªæœ€å°å¯ç”¨äº§å“ï¼ŒåŒ…å«ï¼š
1. ç”¨æˆ·é€šè¿‡Telegramç™»å½•å’Œé€‰æ‹©å…´è¶£
2. æµè§ˆå’Œç‚¹èµžå†…å®¹
3. è´­ä¹°å•†å“(Telegram Starsæ”¯ä»˜)
4. æŸ¥çœ‹ä¸ªäººè®¢å•å’Œå£°æœ›
5. ä¾›åº”å•†ç®¡ç†å•†å“å’Œè®¢å•

## ðŸ› ï¸ æŠ€æœ¯æ ˆ

### åŽç«¯ (å•ä½“åº”ç”¨)
- **è¯­è¨€**: Node.js 20
- **æ¡†æž¶**: Express.js
- **æ•°æ®åº“**: PostgreSQL (Dockerå®¹å™¨)
- **ç¼“å­˜**: Redis (Dockerå®¹å™¨)
- **æ¶ˆæ¯é˜Ÿåˆ—**: Redis
- **æ–‡ä»¶å­˜å‚¨**: æœ¬åœ°å­˜å‚¨ + æœªæ¥æ‰©å±•OSS

### å‰ç«¯ (Mini Apps)
- **æ¡†æž¶**: Vue 3 + Vite
- **æ ·å¼**: Tailwind CSS
- **çŠ¶æ€ç®¡ç†**: Pinia
- **HTTPå®¢æˆ·ç«¯**: Axios

### éƒ¨ç½²
- **å®¹å™¨åŒ–**: Docker Compose
- **åå‘ä»£ç†**: Nginx
- **å†…ç½‘ç©¿é€**: Cpolar (å¼€å‘çŽ¯å¢ƒ)
- **HTTPS**: Cpolarè‡ªåŠ¨è¯ä¹¦ (å¼€å‘) / Let's Encrypt (ç”Ÿäº§)
- **è¿›ç¨‹ç®¡ç†**: PM2

## ðŸ“‚ é¡¹ç›®ç»“æž„

```
/root/tg-empire/
â”œâ”€â”€ backend/                 # Node.jsåŽç«¯
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ routes/         # APIè·¯ç”±
â”‚   â”‚   â”œâ”€â”€ models/         # æ•°æ®æ¨¡åž‹
â”‚   â”‚   â”œâ”€â”€ middleware/     # ä¸­é—´ä»¶
â”‚   â”‚   â”œâ”€â”€ services/       # ä¸šåŠ¡é€»è¾‘
â”‚   â”‚   â””â”€â”€ utils/          # å·¥å…·å‡½æ•°
â”‚   â”œâ”€â”€ tests/              # æµ‹è¯•æ–‡ä»¶
â”‚   â”œâ”€â”€ package.json
â”‚   â””â”€â”€ Dockerfile
â”œâ”€â”€ frontend/               # Vue3 Mini Apps
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ apps/          # å„ä¸ªMini App
â”‚   â”‚   â”œâ”€â”€ components/    # å…±äº«ç»„ä»¶
â”‚   â”‚   â””â”€â”€ utils/         # å·¥å…·å‡½æ•°
â”‚   â”œâ”€â”€ public/            # é™æ€èµ„æº
â”‚   â”œâ”€â”€ package.json
â”‚   â””â”€â”€ Dockerfile
â”œâ”€â”€ admin/                  # ä¾›åº”å•†åŽå°
â”‚   â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ public/
â”‚   â”œâ”€â”€ package.json
â”‚   â””â”€â”€ Dockerfile
â”œâ”€â”€ docs/                   # é¡¹ç›®æ–‡æ¡£
â”‚   â”œâ”€â”€ prd/               # äº§å“éœ€æ±‚æ–‡æ¡£
â”‚   â””â”€â”€ tdd/               # æŠ€æœ¯è®¾è®¡æ–‡æ¡£
â”œâ”€â”€ config/                 # é…ç½®æ–‡ä»¶
â”œâ”€â”€ scripts/               # éƒ¨ç½²è„šæœ¬
â”œâ”€â”€ uploads/               # æ–‡ä»¶ä¸Šä¼ ç›®å½•
â”œâ”€â”€ docker-compose.yml      # å®¹å™¨ç¼–æŽ’
â”œâ”€â”€ nginx.conf             # Nginxé…ç½®
â””â”€â”€ .env                   # çŽ¯å¢ƒå˜é‡
```

## ðŸš€ å¼€å‘ä»»åŠ¡åˆ—è¡¨

### âœ… ä»»åŠ¡1: çŽ¯å¢ƒæ­å»º (è¿›è¡Œä¸­)
- [x] SSHè¿žæŽ¥é…ç½®
- [x] é¡¹ç›®ç»“æž„åˆ›å»º
- [ ] DockerçŽ¯å¢ƒéƒ¨ç½²
- [ ] Node.jsçŽ¯å¢ƒé…ç½®
- [ ] æ•°æ®åº“åˆå§‹åŒ–

### ðŸ“‹ ä»»åŠ¡2: Telegram Boté…ç½®
- [ ] Bot Tokené…ç½®
- [ ] Webhookè®¾ç½®
- [ ] åŸºç¡€æ¶ˆæ¯å¤„ç†

### ðŸ“‹ ä»»åŠ¡3: ç”¨æˆ·èº«ä»½ç³»ç»Ÿ
- [ ] ç”¨æˆ·è‡ªåŠ¨æ³¨å†Œ
- [ ] Telegram OAuth
- [ ] ç”¨æˆ·æ•°æ®å­˜å‚¨
- [ ] å…´è¶£æ ‡ç­¾é€‰æ‹©

### ðŸ“‹ ä»»åŠ¡4: å†…å®¹å±•ç¤ºMini App
- [ ] å†…å®¹åˆ—è¡¨å±•ç¤º
- [ ] å†…å®¹è¯¦æƒ…é¡µé¢
- [ ] ç‚¹èµžåŠŸèƒ½
- [ ] åŸºç¡€æŽ¨èç®—æ³•

### ðŸ“‹ ä»»åŠ¡5: å•†å“å±•ç¤ºå’Œè´­ä¹°
- [ ] å•†å“åˆ—è¡¨å’Œè¯¦æƒ…
- [ ] è´­ç‰©è½¦åŠŸèƒ½
- [ ] è®¢å•åˆ›å»º
- [ ] Telegram Starsæ”¯ä»˜

### ðŸ“‹ ä»»åŠ¡6: ä¸ªäººä¸­å¿ƒMini App
- [ ] è®¢å•çŠ¶æ€æŸ¥çœ‹
- [ ] å£°æœ›ç³»ç»Ÿ
- [ ] ç”¨æˆ·èµ„æ–™å±•ç¤º
- [ ] æ¯æ—¥ç­¾åˆ°

### ðŸ“‹ ä»»åŠ¡7: ä¾›åº”å•†åŽå°
- [ ] å•†å“ç®¡ç†
- [ ] è®¢å•ç®¡ç†
- [ ] æ•°æ®ç»Ÿè®¡

### ðŸ“‹ ä»»åŠ¡8: æµ‹è¯•å’Œéƒ¨ç½²
- [ ] åŠŸèƒ½æµ‹è¯•
- [ ] æ€§èƒ½æµ‹è¯•
- [ ] ç”Ÿäº§çŽ¯å¢ƒéƒ¨ç½²

## ðŸ”§ Telegram Botä¿¡æ¯

```
Bot Username: @TupianXZ_bot
Bot Token: 799873409:AAEuUvkK2I948UY0xZ5rp_VNDnPJK0RMsec
Webhook URL: https://150.109.95.231/webhook
```

## ðŸ“± æµ‹è¯•è®¡åˆ’

### ç”¨æˆ·æµ‹è¯•æµç¨‹
1. **æ³¨å†Œæµ‹è¯•**: ç”¨Telegramè´¦å·æµ‹è¯•æ³¨å†Œæµç¨‹
2. **å†…å®¹æµ‹è¯•**: æµè§ˆå†…å®¹ï¼Œç‚¹èµžæµ‹è¯•
3. **è´­ä¹°æµ‹è¯•**: å®Œæ•´çš„è´­ä¹°æµç¨‹æµ‹è¯•
4. **ç®¡ç†æµ‹è¯•**: ä¾›åº”å•†åŽå°åŠŸèƒ½æµ‹è¯•

## ðŸŽ¯ æˆåŠŸæ ‡å‡†

MVPå®ŒæˆåŽï¼Œåº”è¯¥èƒ½å¤Ÿï¼š
1. âœ… ç”¨æˆ·å¯ä»¥é€šè¿‡Telegramç™»å½•å¹¶é€‰æ‹©å…´è¶£
2. âœ… ç”¨æˆ·å¯ä»¥æµè§ˆå†…å®¹å¹¶ç‚¹èµž
3. âœ… ç”¨æˆ·å¯ä»¥æµè§ˆå•†å“å¹¶ä¸‹å•
4. âœ… ç”¨æˆ·å¯ä»¥æŸ¥çœ‹è®¢å•çŠ¶æ€
5. âœ… ä¾›åº”å•†å¯ä»¥ç®¡ç†å•†å“å’Œè®¢å•
6. âœ… æ”¯ä»˜æµç¨‹å®Œæ•´å¯ç”¨

## ðŸŒ å†…ç½‘ç©¿é€å¼€å‘æŒ‡å—

### å¼€å‘çŽ¯å¢ƒé…ç½®
```bash
# 1. å®‰è£…Cpolar
curl -L https://www.cpolar.com/static/downloads/install-release-cpolar.sh | sudo bash

# 2. é…ç½®éš§é“
cat > ~/.cpolar/cpolar.yml << EOF
authtoken: YOUR_AUTH_TOKEN
tunnels:
  telegram-webhook:
    proto: http
    addr: 3000
    region: cn
    host_header: rewrite
  static-web:
    proto: http
    addr: 80
    region: cn
    host_header: rewrite
EOF

# 3. å¯åŠ¨æœåŠ¡
sudo systemctl enable cpolar
sudo systemctl start cpolar
```

### å¼€å‘æµç¨‹
1. **å¯åŠ¨éš§é“**: ç¡®ä¿CpolaræœåŠ¡è¿è¡Œ
2. **èŽ·å–URL**: é€šè¿‡APIæˆ–ç®¡ç†ç•Œé¢èŽ·å–éš§é“åœ°å€
3. **æ›´æ–°é…ç½®**: è‡ªåŠ¨æ›´æ–°.envæ–‡ä»¶ä¸­çš„URLé…ç½®
4. **è®¾ç½®Webhook**: å°†éš§é“URLè®¾ç½®ä¸ºBotçš„Webhookåœ°å€
5. **æµ‹è¯•éªŒè¯**: éªŒè¯Telegram Botèƒ½æ­£å¸¸æŽ¥æ”¶æ¶ˆæ¯

### è°ƒè¯•æŠ€å·§
```bash
# ç›‘æŽ§éš§é“çŠ¶æ€
curl -s http://localhost:4040/api/tunnels | jq .

# æµ‹è¯•Webhookè¿žæŽ¥
curl -X POST "$(curl -s http://localhost:4040/api/tunnels | jq -r '.tunnels[0].public_url')/webhook" \
  -H "Content-Type: application/json" -d '{"test": "debug"}'

# æŸ¥çœ‹å®žæ—¶æ—¥å¿—
tail -f ~/tg-empire/logs/backend.log
```

### å¸¸è§é—®é¢˜
- **éš§é“æ–­å¼€**: æ£€æŸ¥ç½‘ç»œè¿žæŽ¥ï¼Œé‡å¯CpolaræœåŠ¡
- **Webhookå¤±æ•ˆ**: é‡æ–°è®¾ç½®Telegram Botçš„Webhookåœ°å€
- **SSLè¯ä¹¦**: Cpolarè‡ªåŠ¨å¤„ç†ï¼Œæ— éœ€æ‰‹åŠ¨é…ç½®

---

## ðŸ“ž å¼€å‘åä½œ

- **å¼€å‘çŽ¯å¢ƒ**: VS Code Remote-SSH
- **ä»£ç åŒæ­¥**: ç›´æŽ¥åœ¨æœåŠ¡å™¨å¼€å‘
- **æµ‹è¯•æ–¹å¼**: å®žæ—¶éƒ¨ç½²æµ‹è¯• + Cpolaréš§é“
- **æ–‡æ¡£æ›´æ–°**: å®žæ—¶æ›´æ–°é¡¹ç›®æ–‡æ¡£
- **éš§é“ç®¡ç†**: ä½¿ç”¨è‡ªåŠ¨åŒ–è„šæœ¬ç»´æŠ¤éš§é“è¿žæŽ¥
